<link rel="stylesheet" type="text/css" href="bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.7.2/css/bootstrap-slider.min.css">
<style>
    .slider.slider-horizontal {
        width: 100%;
    }
    
    .superscript {
        vertical-align: super;
        font-size: 10px;
    }
    
    #calculate-button {
        width: 45%;
    }
    #alert {
        display: none;
    }
    #calc-container {
        display: flex;
        align-content: center;
    }
    #cargo-form {
        display: inline-block;
        text-align: center;
    }
</style>
<script>
// THE RATES
var rates = [
 {
   "Collection": "Jita",
   "Destination": "1DQ1-A",
   "Rate": 720
 },
 {
   "Collection": "Jita",
   "Destination": "7G-QIG",
   "Rate": 765
 },
 {
   "Collection": "Jita",
   "Destination": "8RQJ-2",
   "Rate": 765
 },
 {
   "Collection": "Jita",
   "Destination": "D-W7F0",
   "Rate": 720
 },
 {
   "Collection": "Jita",
   "Destination": "R5-MM8",
   "Rate": 765
 },
 {
   "Collection": "Amarr",
   "Destination": "1DQ1-A",
   "Rate": 523
 },
 {
   "Collection": "Amarr",
   "Destination": "7G-QIG",
   "Rate": 540
 },
 {
   "Collection": "Amarr",
   "Destination": "8RQJ-2",
   "Rate": 540
 },
 {
   "Collection": "Amarr",
   "Destination": "D-W7F0",
   "Rate": 523
 },
 {
   "Collection": "Amarr",
   "Destination": "R5-MM8",
   "Rate": 540
 },
 {
   "Collection": "1DQ1-A",
   "Destination": "Jita",
   "Rate": 720
 },
 {
   "Collection": "7G-QIG",
   "Destination": "Jita",
   "Rate": 765
 },
 {
   "Collection": "8RQJ-2",
   "Destination": "Jita",
   "Rate": 765
 },
 {
   "Collection": "D-W7F0",
   "Destination": "Jita",
   "Rate": 720
 },
 {
   "Collection": "R5-MM8",
   "Destination": "Jita",
   "Rate": 765
 },
 {
   "Collection": "1DQ1-A",
   "Destination": "Amarr",
   "Rate": 495
 },
 {
   "Collection": "7G-QIG",
   "Destination": "Amarr",
   "Rate": 540
 },
 {
   "Collection": "8RQJ-2",
   "Destination": "Amarr",
   "Rate": 540
 },
 {
   "Collection": "D-W7F0",
   "Destination": "Amarr",
   "Rate": 495
 },
 {
   "Collection": "R5-MM8",
   "Destination": "Amarr",
   "Rate": 540
 },
 {
   "Collection": "7G-QIG",
   "Destination": "1DQ1-A",
   "Rate": 90
 },
 {
   "Collection": "8RQJ-2",
   "Destination": "1DQ1-A",
   "Rate": 90
 },
 {
   "Collection": "D-W7F0",
   "Destination": "1DQ1-A",
   "Rate": 90
 },
 {
   "Collection": "R5-MM8",
   "Destination": "1DQ1-A",
   "Rate": 90
 },
 {
   "Collection": "1DQ1-A",
   "Destination": "7G-QIG",
   "Rate": 90
 },
 {
   "Collection": "1DQ1-A",
   "Destination": "8RQJ-2",
   "Rate": 90
 },
 {
   "Collection": "1DQ1-A",
   "Destination": "D-W7F0",
   "Rate": 90
 },
 {
   "Collection": "1DQ1-A",
   "Destination": "R5-MM8",
   "Rate": 90
 }
]
</script>
<div class="container">
    <!-- Cargo Form -->
    <form id="cargo-form" class="form-horizontal col-lg-6 col-lg-offset-2 col-md-8 col-md-offset-1 col-xs-12">
        <!-- Collection -->
        <div class="form-group">
            <label class="control-label col-lg-4" for="collection">Collection: </label>
            <div class="col-lg-8">
                <select class="form-control" id="collection">

                </select>
            </div>
        </div>
        <!-- Destination -->
        <div class="form-group">
            <label class="control-label col-lg-4" for="destination">Destination: </label>
            <div class="col-lg-8">
                <select class="form-control" id="destination">

                </select>
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-lg-4" for="cargo-input">Rate: </label>
            <div class="col-lg-8">
                <input type="text" class="form-control" id="rate" value="720" readonly>
            </div>
        </div>
        <!-- Cargo Size -->
        <div class="form-group">
            <div class="col-lg-8 col-lg-offset-4">
                <input type="number" class="form-control" id="cargo-input" placeholder="Enter cargo size or select from below">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-lg-4" for="cargo-input">Cargo Size: </label>
            <div class="col-lg-8">
                <div class="input-group">
                    <input type="text" class="form-control" id="cargo" value="100000" readonly>
                    <span class="input-group-addon">m<span class="superscript">3</span></span>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-lg-8 col-lg-offset-4">
                <input id="cargo-slider" type="text" />
            </div>
        </div>
        <div class="form-group">
            <div class="col-lg-8 col-lg-offset-4">
                <button id="calculate-button" type="button" class="btn btn-default">Calculate</button>
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-lg-4" for="cargo-input">Result: </label>
            <div class="col-lg-8">                
                <input type="text" class="form-control" id="result" readonly>
            </div>
        </div>
        <div id="alert" class="alert alert-warning col-lg-offset-2">
            <strong>We are sorry!</strong> but we don't offer services from the above locations.
        </div>
    </form>
</div>
<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.7.2/bootstrap-slider.min.js"></script>
<script>
    (function () {
        // Add slider and event handler
        $('#cargo-slider').slider({
            min: 0,
            max: 350000,
            step: 10000,
            tooltip: 'hide',
            ticks: [0, 350000],
            ticks_labels: ['0', '350000'],
            handle: 'square'
        }).change(function () {
            $('#cargo').val($('#cargo-slider').val());
            $('#cargo-input').val("");
        }).slider('setValue', 100000);

        // Add cargo size input handler 
        $('#cargo-input').on('input', function () {
            var cargoVal = $('#cargo-input').val();
            $('#cargo').val(cargoVal);
            if (cargoVal >= 0 && cargoVal <= 350000) {
                $('#cargo-slider').slider('setValue', cargoVal);
            }
        });

        // Add collection and destination options from the JSON object
        var collectionOptions = "",
            usedCollectionOptions = [],
            destinationOptions = "",
            usedDestinationOptions = [];
        rates.forEach(function (current) {
            if (usedCollectionOptions.indexOf(current.Collection) == -1) {
                collectionOptions += '<option value="' + current.Collection + '">' + current.Collection +
                    '</option>';
                usedCollectionOptions.push(current.Collection);
            }
            if (usedDestinationOptions.indexOf(current.Destination) == -1) {
                destinationOptions += '<option value="' + current.Destination + '">' + current.Destination +
                    '</option>';
                usedDestinationOptions.push(current.Destination);
            }
        })
        $("#collection").append(collectionOptions);
        $("#destination").append(destinationOptions);

        // Add rate event handlers
        $('#collection').change(function() {
            $('#rate').val(getRate($('#collection').val(), $('#destination').val()));
        });
        $('#destination').change(function() {
            $('#rate').val(getRate($('#collection').val(), $('#destination').val()));
        })

        function getRate(col, dest) {
            var rate = 0;
            rates.forEach(function (current) {
                if (current.Collection === col && current.Destination === dest) {
                    rate = current.Rate;
                }
            });
            return rate;
        }
        
        $('#calculate-button').click(function() {
            var rate = getRate($('#collection').val(), $('#destination').val());
            $('#result').val(rate * $('#cargo').val());
            if ($('#result').val() == 0) {
                $('#alert').css('display', 'block');
            } else {
                $('#alert').css('display', 'none');
            }
        })
    }());
</script>